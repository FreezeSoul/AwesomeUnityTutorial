# 东方ARPG战斗系统设计文档

## 一、基础战斗机制

1. 普通攻击连击系统
   - 轻攻击连击（3段）
     * 第一段：快速挥砍（0.3秒）
     * 第二段：横向斩击（0.4秒）
     * 第三段：上撩终结（0.5秒）
   
   - 重攻击连击（2段）
     * 第一段：蓄力冲击（1.2秒）
     * 第二段：破防重击（1.5秒）

   - 轻重混合连击
     * 轻轻重：快速连击后重击
     * 轻重轻：穿插式连击组合
     * 重轻轻：开路后快速输出

2. 闪避和格挡系统
   - 闪避机制
     * 短距离位移（5米）
     * 无敌帧时间：0.3秒
     * 气力消耗：20点
     * 冷却时间：1秒
   
   - 格挡机制
     * 完美格挡窗口：0.2秒
     * 普通格挡减伤：80%
     * 完美格挡反击机会
     * 气力消耗：10点/秒

3. 硬直与霸体设计
   - 硬直系统
     * 轻击硬直：0.2秒
     * 重击硬直：0.5秒
     * 被击硬直：0.3-0.8秒
     * 倒地硬直：2秒
   
   - 霸体状态
     * 重击蓄力时
     * 特定技能期间
     * BOSS特殊阶段
     * 受击超级护甲

4. 受击反馈与打击感
   - 视觉反馈
     * 打击特效
     * 震屏效果
     * 伤害数字
     * 硬直动画
   
   - 音效设计
     * 武器挥舞音
     * 击中音效
     * 格挡音效
     * 受伤音效

## 二、技能系统设计

1. 技能类型划分
   - 主动攻击技能
     * 单体伤害型
     * 范围攻击型
     * 持续伤害型
     * 条件触发型
   
   - 增益辅助技能
     * 属性强化型
     * 状态赋予型
     * 特殊效果型
     * 资源恢复型
   
   - 战术位移技能
     * 突进型
     * 闪避型
     * 跳跃型
     * 瞬移型
   
   - 元素技能
     * 金：破甲穿刺
     * 木：生命汲取
     * 水：减速控制
     * 火：爆发灼烧
     * 土：防御强化

2. 技能释放机制
   - 释放方式
     * 指向释放
     * 区域选择
     * 自身施法
     * 蓄力释放
   
   - 技能衔接
     * 普攻取消
     * 技能连招
     * 元素联动
     * 武器切换

3. 冷却与消耗设计
   - 冷却时间
     * A级技能：30秒
     * B级技能：20秒
     * C级技能：10秒
     * D级技能：5秒
   
   - 资源消耗
     * 气力值消耗
     * 元素能量消耗
     * HP消耗（特殊技能）
     * 道具消耗

4. 技能升级路线
   - 等级提升效果
     * 伤害提升
     * 冷却缩减
     * 效果强化
     * 范围扩大
   
   - 技能进阶
     * 效果变异
     * 附加特效
     * 机制改变
     * 元素转换

## 三、战斗节奏控制

1. 攻击节奏设计
   - 基础攻击节奏
     * 普攻间隔：0.5秒
     * 连击窗口：0.8秒
     * 技能前摇：0.2-0.5秒
     * 技能后摇：0.3-0.6秒
   
   - combo设计
     * 基础连击倍率：1.1x
     * 最大连击加成：2.0x
     * 连击保持时间：5秒
     * 段数衰减规则

2. 战斗流程控制
   - 开场阶段
     * 观察阶段（1-2秒）
     * 试探阶段（3-5秒）
     * 节奏建立（5-8秒）
   
   - 中期战斗
     * 技能交换
     * 资源管理
     * 走位周旋
     * 连击积累

   - 结束阶段
     * 爆发输出
     * 追击处理
     * 收尾技能
     * 战利品收集

3. 打断与反制机制
   - 打断系统
     * 硬直打断
     * 技能打断
     * 霸体击破
     * 架势崩坏
   
   - 反制设计
     * 反击窗口
     * 弹反机制
     * 招架反制
     * 破绽利用

## 四、敌人AI行为设计

1. AI决策模式
   - 基础行为树
     * 待机状态
     * 警戒状态
     * 战斗状态
     * 撤退状态
   
   - 战斗策略
     * 攻击距离判断
     * 招式选择权重
     * 配合行为判定
     * 特殊状态响应

2. 攻击模式设计
   - 基础攻击
     * 普通攻击组合
     * 范围技能释放
     * 追击判定
     * 防御反击
   
   - 特殊攻击
     * 蓄力大招
     * 连携技能
     * 陷阱布置
     * 召唤支援

3. 配合机制
   - 小怪配合
     * 包围战术
     * 远近结合
     * 元素配合
     * 技能联动
   
   - 精英怪特性
     * 指挥增益
     * 战术调度
     * 特殊能力
     * 小怪强化

4. 难度梯度
   - 普通怪物
     * 基础血量：500-1000
     * 攻击力：50-100
     * 防御力：30-60
     * AI复杂度：低
   
   - 精英怪物
     * 基础血量：2000-3000
     * 攻击力：150-200
     * 防御力：80-120
     * AI复杂度：中
   
   - BOSS设计
     * 基础血量：8000-10000
     * 攻击力：300-500
     * 防御力：150-200
     * AI复杂度：高

## 五、武器系统设计

1. 基础武器类型
   - 单手武器
     * 单手剑：灵活快速
     * 单手斧：破防强化
     * 单手锤：击晕效果
     * 短刀：暴击提升
   
   - 双手武器
     * 双手剑：范围伤害
     * 双手斧：高额伤害
     * 双手枪：突刺攻击
     * 长柄武器：距离优势

2. 武器特性设计
   - 基础属性
     * 伤害范围
     * 攻击速度
     * 暴击倍率
     * 元素亲和
   
   - 特殊效果
     * 武器技能
     * 被动加成
     * 元素附魔
     * 连击特效

3. 武器升级系统
   - 强化系统
     * 基础强化（+1到+10）
     * 进阶强化（+11到+15）
     * 完美强化（+16到+20）
     * 特殊强化效果
   
   - 改造系统
     * 属性词条添加
     * 特效改造
     * 外观定制
     * 套装改造

## 六、伤害计算系统

1. 基础伤害公式
```
最终伤害 = (基础伤害 + 附加伤害) * (1 + 增伤系数) * (1 - 减伤系数) * (1 + 暴击伤害) * 元素相性系数
```

2. 伤害系数详解
   - 基础伤害
     * 武器伤害
     * 技能倍率
     * 属性加成
     * 等级差异
   
   - 增伤系数
     * 技能增伤
     * buff加成
     * 特殊状态
     * 连击加成

3. 元素伤害系统
   - 相生相克
     * 相生：伤害1.2倍
     * 相克：伤害1.5倍
     * 同性：伤害0.8倍
     * 中性：伤害1.0倍
   
   - 元素叠加
     * 双重元素
     * 三重元素
     * 元素爆发
     * 特殊反应

4. 防御计算
   - 物理防御
     * 基础减伤
     * 护甲穿透
     * 固定减伤
     * 百分比减伤
   
   - 元素防御
     * 元素抗性
     * 抗性穿透
     * 元素减免
     * 特殊防御
